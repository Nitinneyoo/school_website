import{u as F,a as P,r as a,j as e,m as l,A}from"./index-BDf_TsDU.js";import{u as B}from"./resultsService-B9PMRIiY.js";import{l as E}from"./userService-DghBrlAQ.js";import{B as R}from"./BackButton-BRAmd2mt.js";import{U as u}from"./upload-Dl60ZD-b.js";import{C as T}from"./circle-check-big-D1_pqvgl.js";import{F as $}from"./file-text-BzL20uYq.js";import{C as M}from"./circle-alert-BHJADlnO.js";import{L}from"./loader-circle-M2huVvUl.js";import"./arrow-left-BBHHI4Cg.js";const q=[1,2,3,4,5,6,7,8,9,10],O=["Mathematics","Science","English","Social Studies","Hindi","Computer Science","Physical Education","Art"],Z=function(){const{user:d,userProfile:m}=F(),j=P(),[t,x]=a.useState(null),[i,y]=a.useState(""),[n,N]=a.useState(""),[o,h]=a.useState(!1),[p,g]=a.useState(0),[f,r]=a.useState(null),[v,w]=a.useState(!1),b=a.useRef(null),S=s=>{s.target.files&&s.target.files[0]&&(x(s.target.files[0]),r(null))},C=s=>{s.preventDefault(),s.dataTransfer.files&&s.dataTransfer.files[0]&&(x(s.dataTransfer.files[0]),r(null))},U=s=>{s.preventDefault()},k=async s=>{if(s.preventDefault(),!t||!i||!n||!d||!m){r("Please fill in all fields and select a file");return}h(!0),r(null),g(0);try{const c=await B(t,Number(i),n,d.uid,m.name,D=>g(D));c.success?(await E(d.uid,m.name,"upload",`Uploaded ${t.name} for Class ${i} - ${n}`),w(!0),setTimeout(()=>{j({to:"/teacher/my-uploads"})},2e3)):r(c.error||"Upload failed")}catch(c){console.error(c),r("An unexpected error occurred")}finally{h(!1)}};return e.jsx("div",{className:"min-h-screen pt-32 pb-20 px-4",children:e.jsxs("div",{className:"max-w-3xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx(R,{to:"/teacher",label:"Back to Dashboard"}),e.jsxs("div",{className:"flex items-center gap-4 mt-8",children:[e.jsx(l.div,{initial:{scale:.5,opacity:0},animate:{scale:1,opacity:1},className:"p-3 rounded-2xl bg-green-500/20 border border-green-500/30",children:e.jsx(u,{className:"h-8 w-8 text-green-400"})}),e.jsxs("div",{children:[e.jsxs(l.h1,{initial:{x:-20,opacity:0},animate:{x:0,opacity:1},className:"text-4xl font-black text-white tracking-tight",children:["Upload ",e.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-green-400 to-emerald-400",children:"Results"})]}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Publish new exam results or study materials"})]})]})]}),e.jsx(l.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.1},className:"glass-card p-8",children:v?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(l.div,{initial:{scale:0},animate:{scale:1},className:"w-20 h-20 bg-green-500 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(T,{className:"h-10 w-10 text-white"})}),e.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Upload Successful!"}),e.jsx("p",{className:"text-gray-400",children:"Redirecting to your uploads..."})]}):e.jsxs("form",{onSubmit:k,className:"space-y-8",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-bold text-gray-300 ml-1",children:"Class"}),e.jsxs("select",{value:i,onChange:s=>y(Number(s.target.value)),className:"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-xl text-white focus:outline-none focus:border-green-500/50 focus:bg-white/10 transition-all appearance-none cursor-pointer",required:!0,children:[e.jsx("option",{value:"",className:"bg-gray-900",children:"Select Class"}),q.map(s=>e.jsxs("option",{value:s,className:"bg-gray-900",children:["Class ",s]},s))]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-bold text-gray-300 ml-1",children:"Subject"}),e.jsxs("select",{value:n,onChange:s=>N(s.target.value),className:"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-xl text-white focus:outline-none focus:border-green-500/50 focus:bg-white/10 transition-all appearance-none cursor-pointer",required:!0,children:[e.jsx("option",{value:"",className:"bg-gray-900",children:"Select Subject"}),O.map(s=>e.jsx("option",{value:s,className:"bg-gray-900",children:s},s))]})]})]}),e.jsxs("div",{onDrop:C,onDragOver:U,onClick:()=>{var s;return(s=b.current)==null?void 0:s.click()},className:`relative border-2 border-dashed rounded-2xl p-12 text-center cursor-pointer transition-all ${t?"border-green-500/50 bg-green-500/10":"border-white/10 hover:border-green-500/30 hover:bg-white/5"}`,children:[e.jsx("input",{type:"file",ref:b,onChange:S,className:"hidden",accept:".pdf,.doc,.docx,.xls,.xlsx"}),e.jsx(A,{mode:"wait",children:t?e.jsxs(l.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},className:"flex flex-col items-center",children:[e.jsx("div",{className:"w-16 h-16 bg-green-500/20 rounded-2xl flex items-center justify-center mb-4 text-green-400",children:e.jsx($,{className:"h-8 w-8"})}),e.jsx("p",{className:"text-lg font-bold text-white mb-1",children:t.name}),e.jsxs("p",{className:"text-sm text-gray-400",children:[(t.size/1024/1024).toFixed(2)," MB"]}),e.jsx("button",{type:"button",onClick:s=>{s.stopPropagation(),x(null)},className:"mt-4 px-4 py-2 bg-red-500/20 text-red-400 text-sm font-bold rounded-lg hover:bg-red-500/30 transition-colors",children:"Remove File"})]}):e.jsxs(l.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},className:"flex flex-col items-center",children:[e.jsx("div",{className:"w-16 h-16 bg-white/5 rounded-2xl flex items-center justify-center mb-4 text-gray-400 group-hover:text-green-400 transition-colors",children:e.jsx(u,{className:"h-8 w-8"})}),e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Drag & drop file here"}),e.jsx("p",{className:"text-gray-400 mb-6",children:"or click to browse"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Supports PDF, Excel, Word (Max 10MB)"})]})})]}),o&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-400",children:"Uploading..."}),e.jsxs("span",{className:"text-green-400 font-bold",children:[Math.round(p),"%"]})]}),e.jsx("div",{className:"h-2 bg-white/10 rounded-full overflow-hidden",children:e.jsx(l.div,{initial:{width:0},animate:{width:`${p}%`},className:"h-full bg-gradient-to-r from-green-500 to-emerald-500"})})]}),f&&e.jsxs(l.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"p-4 bg-red-500/20 border border-red-500/30 rounded-xl flex items-center gap-3 text-red-400",children:[e.jsx(M,{className:"h-5 w-5 flex-shrink-0"}),e.jsx("p",{className:"font-medium",children:f})]}),e.jsx("button",{type:"submit",disabled:o||!t,className:`w-full py-4 rounded-xl font-black text-lg flex items-center justify-center gap-2 transition-all ${o||!t?"bg-gray-500/20 text-gray-500 cursor-not-allowed":"bg-gradient-to-r from-green-500 to-teal-500 text-white hover:from-green-600 hover:to-teal-600 shadow-lg shadow-green-500/25 hover:shadow-green-500/40 hover:-translate-y-1"}`,children:o?e.jsxs(e.Fragment,{children:[e.jsx(L,{className:"h-5 w-5 animate-spin"}),"Uploading..."]}):e.jsxs(e.Fragment,{children:[e.jsx(u,{className:"h-5 w-5"}),"Upload Result"]})})]})})]})})};export{Z as component};
