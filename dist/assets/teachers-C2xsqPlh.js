import{c as N,b as T,r as n,j as e,X as A,z as M,M as k,A as E}from"./index-DtGsV18p.js";import{u as L,d as P,g as $,b as D}from"./userService-FbXA3mHu.js";import{E as F}from"./eye-CotrEgV8.js";import{A as v}from"./activity-LxPQIPBW.js";import{T as _}from"./trash-2-CqbBgcW4.js";import{B}from"./BackButton-D4yM1BFD.js";import{U as C}from"./users-spmG4Jwz.js";import{S as U}from"./search-C3QYOEv9.js";import{C as z}from"./circle-check-big-I3Nzl0D9.js";import{C as O}from"./circle-x-RX2tPfvQ.js";import"./arrow-left-4XXxvi_S.js";/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]],q=N("ellipsis-vertical",R);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],V=N("eye-off",J);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Y=N("plus",X);/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=[["path",{d:"M12 2v10",key:"mnfbl"}],["path",{d:"M18.4 6.6a9 9 0 1 1-12.77.04",key:"obofu9"}]],H=N("power",G),I=["Mathematics","Science","English","Hindi","Social Studies","Computer Science","Physical Education","Art","Music"];function K({teacher:l,onClose:h,onSuccess:b}){const{userProfile:x}=T(),[s,r]=n.useState({email:(l==null?void 0:l.email)||"",password:"",name:(l==null?void 0:l.name)||"",subjects:(l==null?void 0:l.subjects)||[]}),[i,p]=n.useState(!1),[m,u]=n.useState(!1),[o,g]=n.useState(""),f=()=>{const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*";let d="";for(let w=0;w<12;w++)d+=t.charAt(Math.floor(Math.random()*t.length));r({...s,password:d})},j=async t=>{if(t.preventDefault(),g(""),u(!0),!s.password||s.password.length<6){g("Password must be at least 6 characters"),u(!1);return}if(s.subjects.length===0){g("Please select at least one subject"),u(!1);return}const d=await M(s,(x==null?void 0:x.uid)||"");d.success?(alert(`✅ Teacher account created successfully!

Email: ${s.email}
Name: ${s.name}
Subjects: ${s.subjects.join(", ")}

⚠️ Note: You have been logged out due to Firebase limitations.
You will be redirected to the login page.`),sessionStorage.setItem("teacherCreated",JSON.stringify({name:s.name,email:s.email})),setTimeout(()=>{window.location.href="/login"},1e3)):(g(d.error||"Failed to create teacher account"),u(!1))},y=t=>{s.subjects.includes(t)?r({...s,subjects:s.subjects.filter(d=>d!==t)}):r({...s,subjects:[...s.subjects,t]})};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white p-6 rounded-t-2xl",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-bold",children:l?"Edit Teacher":"Create New Teacher"}),e.jsx("button",{onClick:h,className:"p-2 hover:bg-white/20 rounded-lg transition-colors",children:e.jsx(A,{className:"h-6 w-6"})})]})}),e.jsxs("form",{onSubmit:j,className:"p-6 space-y-6",children:[o&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",children:o}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Full Name *"}),e.jsx("input",{type:"text",required:!0,value:s.name,onChange:t=>r({...s,name:t.target.value}),className:"w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"John Doe"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address *"}),e.jsx("input",{type:"email",required:!0,value:s.email,onChange:t=>r({...s,email:t.target.value}),className:"w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"teacher@school.com",disabled:!!l})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Password *"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx("input",{type:i?"text":"password",required:!0,value:s.password,onChange:t=>r({...s,password:t.target.value}),className:"w-full px-4 py-3 pr-12 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Min. 6 characters",minLength:6}),e.jsx("button",{type:"button",onClick:()=>p(!i),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700",children:i?e.jsx(V,{className:"h-5 w-5"}):e.jsx(F,{className:"h-5 w-5"})})]}),e.jsx("button",{type:"button",onClick:()=>f(),className:"px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg transition-colors font-medium",children:"Generate"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Password must be at least 6 characters"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Subjects Taught *"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:I.map(t=>e.jsx("button",{type:"button",onClick:()=>y(t),className:`px-4 py-2 rounded-lg border-2 transition-all font-medium ${s.subjects.includes(t)?"bg-blue-50 border-blue-500 text-blue-700":"bg-white border-gray-200 text-gray-700 hover:border-gray-300"}`,children:t},t))}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:[s.subjects.length," subject(s) selected"]})]}),e.jsxs("div",{className:"flex gap-3 pt-4 border-t",children:[e.jsx("button",{type:"button",onClick:h,className:"flex-1 px-6 py-3 border-2 border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors font-medium",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:m,className:"flex-1 px-6 py-3 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-lg hover:from-blue-700 hover:to-purple-700 transition-all shadow-md hover:shadow-lg font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:m?"Creating...":l?"Update Teacher":"Create Teacher"})]})]})]})})}function Q({teacher:l,onRefresh:h,onShowActivities:b}){const[x,s]=n.useState(!1),[r,i]=n.useState(!1),p=async()=>{i(!0);const o=await L(l.uid,!l.isActive);o.success?h():alert(o.error||"Failed to update status"),i(!1),s(!1)},m=async()=>{if(confirm(`Send password reset email to ${l.email}?`)){i(!0);const o=await E(l.email);o.success?alert("Password reset email sent successfully!"):alert(o.error||"Failed to send reset email"),i(!1),s(!1)}},u=async()=>{if(confirm(`Are you sure you want to delete ${l.name}? This action cannot be undone.`)){i(!0);const o=await P(l.uid);o.success?(alert("Teacher deleted successfully"),h()):alert(o.error||"Failed to delete teacher"),i(!1),s(!1)}};return e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>s(!x),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",disabled:r,children:e.jsx(q,{className:"h-5 w-5 text-gray-600"})}),x&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>s(!1)}),e.jsxs("div",{className:"absolute right-0 top-full mt-2 w-56 bg-white rounded-lg shadow-xl border border-gray-200 z-20 overflow-hidden",children:[e.jsxs("button",{onClick:b,className:"w-full flex items-center gap-3 px-4 py-3 hover:bg-gray-50 transition-colors text-left",children:[e.jsx(v,{className:"h-4 w-4 text-gray-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"View Activity"})]}),e.jsxs("button",{onClick:m,className:"w-full flex items-center gap-3 px-4 py-3 hover:bg-gray-50 transition-colors text-left",disabled:r,children:[e.jsx(k,{className:"h-4 w-4 text-blue-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Reset Password"})]}),e.jsxs("button",{onClick:p,className:"w-full flex items-center gap-3 px-4 py-3 hover:bg-gray-50 transition-colors text-left",disabled:r,children:[e.jsx(H,{className:`h-4 w-4 ${l.isActive?"text-red-600":"text-green-600"}`}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:l.isActive?"Disable Account":"Enable Account"})]}),e.jsx("div",{className:"border-t border-gray-200",children:e.jsxs("button",{onClick:u,className:"w-full flex items-center gap-3 px-4 py-3 hover:bg-red-50 transition-colors text-left",disabled:r,children:[e.jsx(_,{className:"h-4 w-4 text-red-600"}),e.jsx("span",{className:"text-sm font-medium text-red-600",children:"Delete Teacher"})]})})]})]})]})}const ce=function(){const[h,b]=n.useState([]),[x,s]=n.useState(!0),[r,i]=n.useState(""),[p,m]=n.useState(!1),[u,o]=n.useState(null),[g,f]=n.useState(null),[j,y]=n.useState([]),t=async()=>{s(!0);const a=await $();b(a),s(!1)};n.useEffect(()=>{t()},[]);const d=h.filter(a=>a.name.toLowerCase().includes(r.toLowerCase())||a.email.toLowerCase().includes(r.toLowerCase())),w=async a=>{if(g===a)f(null),y([]);else{f(a);const c=await D(a);y(c)}};return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-white shadow-sm border-b",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[e.jsx(B,{to:"/admin",label:"Back to Dashboard"}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 mt-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(C,{className:"h-8 w-8 text-blue-600"}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Teacher Management"})]}),e.jsxs("button",{onClick:()=>{o(null),m(!0)},className:"flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-lg hover:from-blue-700 hover:to-purple-700 transition-all shadow-md hover:shadow-lg font-medium",children:[e.jsx(Y,{className:"h-5 w-5"}),"Create New Teacher"]})]})]})}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 mb-6",children:e.jsxs("div",{className:"relative",children:[e.jsx(U,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search teachers by name or email...",value:r,onChange:a=>i(a.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})}),x?e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-8 text-center",children:[e.jsx("div",{className:"w-16 h-16 border-4 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading teachers..."})]}):d.length===0?e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-8 text-center",children:[e.jsx(C,{className:"h-16 w-16 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 text-lg",children:r?"No teachers found matching your search":"No teachers yet"}),!r&&e.jsx("button",{onClick:()=>m(!0),className:"mt-4 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Create your first teacher"})]}):e.jsx("div",{className:"space-y-4",children:d.map(a=>e.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:a.name}),a.isActive?e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-green-100 text-green-700 text-xs font-medium rounded-full",children:[e.jsx(z,{className:"h-3 w-3"}),"Active"]}):e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-red-100 text-red-700 text-xs font-medium rounded-full",children:[e.jsx(O,{className:"h-3 w-3"}),"Disabled"]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-600 mb-2",children:[e.jsx(k,{className:"h-4 w-4"}),e.jsx("span",{children:a.email})]}),a.subjects&&a.subjects.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mt-3",children:a.subjects.map(c=>e.jsx("span",{className:"px-3 py-1 bg-blue-50 text-blue-700 text-sm rounded-full font-medium",children:c},c))}),a.lastLogin&&e.jsxs("p",{className:"text-sm text-gray-500 mt-3",children:["Last login: ",a.lastLogin.toLocaleString()]})]}),e.jsx(Q,{teacher:a,onRefresh:t,onShowActivities:()=>w(a.uid)})]})}),g===a.uid&&e.jsxs("div",{className:"border-t border-gray-200 bg-gray-50 p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(v,{className:"h-5 w-5 text-gray-600"}),e.jsx("h4",{className:"font-semibold text-gray-900",children:"Recent Activity"})]}),j.length===0?e.jsx("p",{className:"text-gray-600 text-sm",children:"No activity recorded"}):e.jsx("div",{className:"space-y-2",children:j.map(c=>{var S;return e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-white rounded-lg border border-gray-200",children:[e.jsx("div",{className:`p-1 rounded-full ${c.action==="upload"?"bg-green-100":c.action==="delete"?"bg-red-100":"bg-blue-100"}`,children:e.jsx(v,{className:`h-4 w-4 ${c.action==="upload"?"text-green-600":c.action==="delete"?"text-red-600":"text-blue-600"}`})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm text-gray-900",children:c.details}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:(S=c.timestamp)==null?void 0:S.toLocaleString()})]})]},c.id)})})]})]},a.uid))})]}),p&&e.jsx(K,{teacher:u,onClose:()=>{m(!1),o(null)},onSuccess:()=>{m(!1),o(null),t()}})]})};export{ce as component};
