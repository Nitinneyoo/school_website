import{u as C,r as a,j as e,m as i,A}from"./index-BDf_TsDU.js";import{a as L,d as k}from"./resultsService-B9PMRIiY.js";import{l as D}from"./userService-DghBrlAQ.js";import{B as U}from"./BackButton-BRAmd2mt.js";import{F as n}from"./file-text-BzL20uYq.js";import{S as F}from"./search-BUFUGeSp.js";import{F as T}from"./funnel-BFAeYe6A.js";import{D as B}from"./download-DqUevTWn.js";import{T as R}from"./trash-2-CMpFvCb3.js";import"./arrow-left-BBHHI4Cg.js";const K=function(){const{user:l,userProfile:p}=C(),[r,g]=a.useState([]),[f,u]=a.useState(!0),[c,b]=a.useState(""),[d,j]=a.useState(""),[m,N]=a.useState(""),x=a.useCallback(async()=>{if(l){u(!0);const s=await L(l.uid);g(s),u(!1)}},[l]);a.useEffect(()=>{x()},[x]);const y=async s=>{if(confirm(`Are you sure you want to delete "${s.fileName}"?`)){const t=await k(s.id,s.fileURL);t.success?(l&&p&&await D(l.uid,p.name,"delete",`Deleted ${s.fileName} for Class ${s.class} - ${s.subject}`),x()):alert(t.error||"Failed to delete file")}},h=r.filter(s=>{const t=s.fileName.toLowerCase().includes(c.toLowerCase())||s.subject.toLowerCase().includes(c.toLowerCase()),o=d===""||s.class===d,S=m===""||s.subject===m;return t&&o&&S}),w=Array.from(new Set(r.map(s=>s.class))).sort((s,t)=>s-t),v=Array.from(new Set(r.map(s=>s.subject))).sort();return e.jsxs("div",{className:"min-h-screen pt-32 pb-20 px-4",children:[e.jsxs("div",{className:"max-w-7xl mx-auto mb-8",children:[e.jsx(U,{to:"/teacher",label:"Back to Dashboard"}),e.jsxs("div",{className:"flex items-center gap-4 mt-8",children:[e.jsx(i.div,{initial:{scale:.5,opacity:0},animate:{scale:1,opacity:1},className:"p-3 rounded-2xl bg-teal-500/20 border border-teal-500/30",children:e.jsx(n,{className:"h-8 w-8 text-teal-400"})}),e.jsxs("div",{children:[e.jsxs(i.h1,{initial:{x:-20,opacity:0},animate:{x:0,opacity:1},className:"text-4xl font-black text-white tracking-tight",children:["My ",e.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-teal-400 to-emerald-400",children:"Uploads"})]}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Manage your uploaded results and files"})]})]})]}),e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx(i.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.1},className:"glass-card p-4 mb-8",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(F,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search files...",value:c,onChange:s=>b(s.target.value),className:"w-full pl-12 pr-4 py-3 bg-white/5 border border-white/10 rounded-xl text-white placeholder-gray-500 focus:outline-none focus:border-teal-500/50 focus:bg-white/10 transition-all"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(T,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),e.jsxs("select",{value:d,onChange:s=>j(s.target.value?Number(s.target.value):""),className:"w-full pl-12 pr-4 py-3 bg-white/5 border border-white/10 rounded-xl text-white focus:outline-none focus:border-teal-500/50 focus:bg-white/10 transition-all appearance-none cursor-pointer",children:[e.jsx("option",{value:"",className:"bg-gray-900",children:"All Classes"}),w.map(s=>e.jsxs("option",{value:s,className:"bg-gray-900",children:["Class ",s]},s))]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(n,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),e.jsxs("select",{value:m,onChange:s=>N(s.target.value),className:"w-full pl-12 pr-4 py-3 bg-white/5 border border-white/10 rounded-xl text-white focus:outline-none focus:border-teal-500/50 focus:bg-white/10 transition-all appearance-none cursor-pointer",children:[e.jsx("option",{value:"",className:"bg-gray-900",children:"All Subjects"}),v.map(s=>e.jsx("option",{value:s,className:"bg-gray-900",children:s},s))]})]})]})}),f?e.jsxs("div",{className:"glass-card p-12 text-center",children:[e.jsx("div",{className:"w-16 h-16 border-4 border-teal-500/30 border-t-teal-500 rounded-full animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-gray-400",children:"Loading uploads..."})]}):h.length===0?e.jsxs("div",{className:"glass-card p-12 text-center",children:[e.jsx(n,{className:"h-16 w-16 text-gray-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-300 text-lg font-medium",children:r.length===0?"No uploads yet":"No uploads match your filters"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:e.jsx(A,{children:h.map((s,t)=>{var o;return e.jsxs(i.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:t*.05},className:"glass-card p-6 group hover:border-white/20 transition-all",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"bg-teal-500/20 p-3 rounded-xl flex-shrink-0 text-teal-400 group-hover:bg-teal-500/30 transition-colors",children:e.jsx(n,{className:"h-8 w-8"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-bold text-white truncate text-lg",title:s.fileName,children:s.fileName}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsxs("span",{className:"px-2.5 py-1 bg-blue-500/20 text-blue-300 border border-blue-500/30 text-xs rounded-lg font-medium",children:["Class ",s.class]}),e.jsx("span",{className:"px-2.5 py-1 bg-purple-500/20 text-purple-300 border border-purple-500/30 text-xs rounded-lg font-medium",children:s.subject})]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-4 font-mono",children:["Uploaded on ",(o=s.uploadedAt)==null?void 0:o.toLocaleDateString()]})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6 pt-4 border-t border-white/5",children:[e.jsxs("a",{href:s.fileURL,target:"_blank",rel:"noopener noreferrer",className:"flex-1 flex items-center justify-center gap-2 px-4 py-2.5 bg-teal-500/20 text-teal-300 border border-teal-500/30 rounded-xl hover:bg-teal-500/30 transition-all font-bold text-sm",children:[e.jsx(B,{className:"h-4 w-4"}),"Download"]}),e.jsx("button",{onClick:()=>y(s),className:"p-2.5 bg-red-500/20 text-red-400 border border-red-500/30 rounded-xl hover:bg-red-500/30 transition-all",title:"Delete",children:e.jsx(R,{className:"h-4 w-4"})})]})]},s.id)})})})]})]})};export{K as component};
