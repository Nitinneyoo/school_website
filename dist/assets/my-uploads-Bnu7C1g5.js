import{b as S,r as a,j as s}from"./index-CB3QESB1.js";import{b as C,d as L}from"./resultsService-z-ULz6XV.js";import{l as A}from"./userService-CDG9BBIQ.js";import{B as D}from"./BackButton-CPvv4ARp.js";import{F as d}from"./file-text-C7p-1Cf5.js";import{S as U}from"./search-D2V31ikt.js";import{D as k}from"./download-CS5uLprT.js";import{T}from"./trash-2-Bm2MbjKj.js";import"./arrow-left-C0rJTjX8.js";const G=function(){const{user:r,userProfile:m}=S(),[l,h]=a.useState([]),[p,x]=a.useState(!0),[o,g]=a.useState(""),[c,f]=a.useState(""),[i,b]=a.useState(""),n=a.useCallback(async()=>{if(r){x(!0);const e=await C(r.uid);h(e),x(!1)}},[r]);a.useEffect(()=>{n()},[n]);const j=async e=>{if(confirm(`Are you sure you want to delete "${e.fileName}"?`)){const t=await L(e.id,e.fileURL);t.success?(r&&m&&await A(r.uid,m.name,"delete",`Deleted ${e.fileName} for Class ${e.class} - ${e.subject}`),n()):alert(t.error||"Failed to delete file")}},u=l.filter(e=>{const t=e.fileName.toLowerCase().includes(o.toLowerCase())||e.subject.toLowerCase().includes(o.toLowerCase()),v=c===""||e.class===c,y=i===""||e.subject===i;return t&&v&&y}),N=Array.from(new Set(l.map(e=>e.class))).sort((e,t)=>e-t),w=Array.from(new Set(l.map(e=>e.subject))).sort();return s.jsxs("div",{className:"min-h-screen bg-gray-50",children:[s.jsx("div",{className:"bg-white shadow-sm border-b",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[s.jsx(D,{to:"/teacher",label:"Back to Dashboard"}),s.jsxs("div",{className:"flex items-center gap-3 mt-4",children:[s.jsx(d,{className:"h-8 w-8 text-teal-600"}),s.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"My Uploads"})]})]})}),s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[s.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 mb-6",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("div",{className:"relative",children:[s.jsx(U,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),s.jsx("input",{type:"text",placeholder:"Search files...",value:o,onChange:e=>g(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent"})]}),s.jsxs("select",{value:c,onChange:e=>f(e.target.value?Number(e.target.value):""),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent",children:[s.jsx("option",{value:"",children:"All Classes"}),N.map(e=>s.jsxs("option",{value:e,children:["Class ",e]},e))]}),s.jsxs("select",{value:i,onChange:e=>b(e.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent",children:[s.jsx("option",{value:"",children:"All Subjects"}),w.map(e=>s.jsx("option",{value:e,children:e},e))]})]})}),p?s.jsxs("div",{className:"bg-white rounded-lg shadow-md p-8 text-center",children:[s.jsx("div",{className:"w-16 h-16 border-4 border-teal-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600",children:"Loading uploads..."})]}):u.length===0?s.jsxs("div",{className:"bg-white rounded-lg shadow-md p-8 text-center",children:[s.jsx(d,{className:"h-16 w-16 text-gray-300 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600 text-lg",children:l.length===0?"No uploads yet":"No uploads match your filters"})]}):s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:u.map(e=>{var t;return s.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow",children:[s.jsxs("div",{className:"flex items-start gap-4",children:[s.jsx("div",{className:"bg-teal-100 p-3 rounded-lg flex-shrink-0",children:s.jsx(d,{className:"h-8 w-8 text-teal-600"})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h3",{className:"font-semibold text-gray-900 truncate",title:e.fileName,children:e.fileName}),s.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[s.jsxs("span",{className:"px-2 py-1 bg-blue-100 text-blue-700 text-xs rounded-full font-medium",children:["Class ",e.class]}),s.jsx("span",{className:"px-2 py-1 bg-purple-100 text-purple-700 text-xs rounded-full font-medium",children:e.subject})]}),s.jsx("p",{className:"text-xs text-gray-500 mt-3",children:(t=e.uploadedAt)==null?void 0:t.toLocaleDateString()})]})]}),s.jsxs("div",{className:"flex gap-2 mt-4 pt-4 border-t",children:[s.jsxs("a",{href:e.fileURL,target:"_blank",rel:"noopener noreferrer",className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700 transition-colors text-sm font-medium",children:[s.jsx(k,{className:"h-4 w-4"}),"Download"]}),s.jsx("button",{onClick:()=>j(e),className:"p-2 bg-red-50 text-red-600 rounded-lg hover:bg-red-100 transition-colors",title:"Delete",children:s.jsx(T,{className:"h-4 w-4"})})]})]},e.id)})})]})]})};export{G as component};
